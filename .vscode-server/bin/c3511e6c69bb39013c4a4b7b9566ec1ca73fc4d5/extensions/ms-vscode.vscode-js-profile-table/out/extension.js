(()=>{"use strict";var e={553:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=function(e,t){let o=0,r=e.length-1;for(;o<=r;){const n=(o+r)/2|0,i=t(e[n]);if(i<0)o=n+1;else{if(!(i>0))return n;r=n-1}}return-(o+1)},t.addToSet=(e,t)=>{const o=new Set([...e,t]);return o.add(t),o},t.removeFromSet=(e,t)=>{const o=new Set([...e]);return o.delete(t),o},t.toggleInSet=(e,t)=>{const o=new Set([...e]);return o.has(t)?o.delete(t):o.add(t),o};const o=Symbol("unset");t.once=e=>{let t=o;return()=>(t===o&&(t=e()),t)}},456:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(385);t.bundlePage=async(e,t)=>{const o=r.makeNonce();return`<!DOCTYPE html>\n    <html lang="en">\n    <head>\n      <meta charset="UTF-8">\n      <meta name="viewport" content="width=device-width, initial-scale=1.0">\n      ${r.nonceHeader(o)}\n      <title>Profile Custom Editor</title>\n    </head>\n    <body>\n      <script type="text/javascript" nonce="${o}">\n        ${Object.entries(t).map((([e,t])=>`globalThis.${e} = ${JSON.stringify(t)}`)).join(";")}\n      <\/script>\n      <script nonce="${o}" src="${e}"><\/script>\n    </body>\n    </html>\n  `}},748:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.categorize=(e,t)=>(e.functionName=e.functionName||"(anonymous)",e.lineNumber<0?0:e.url.includes("node_modules")||!t?2:1)},808:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(496),n=o(480),i=o(341),s=o(450);class a extends i.ProfileAnnotations{constructor(){super(...arguments),this.data=new Map}set(e,t,o){var i;let s=this.data.get(n.lowerCaseInsensitivePath(e));s||(s=[],this.data.set(n.lowerCaseInsensitivePath(e),s));let a=0;for(;a<s.length&&s[a].position.line<t.line;)a++;if((null===(i=s[a])||void 0===i?void 0:i.position.line)===t.line){const e=s[a];t.character<e.position.character&&(e.position=new r.Position(t.line,t.character)),e.data.aggregateTime+=o.aggregateTime,e.data.selfTime+=o.selfTime,e.data.ticks+=o.ticks}else s.splice(a,0,{position:new r.Position(t.line,t.character),data:{aggregateTime:o.aggregateTime,selfTime:o.selfTime,ticks:o.ticks}})}getLensesForFile(e){var t,o;return this.expandForFile(e),null!==(o=null===(t=this.data.get(n.lowerCaseInsensitivePath(e)))||void 0===t?void 0:t.map((({position:e,data:t})=>{if(0===t.aggregateTime&&0===t.selfTime)return[];const o=new r.Range(e,e);return[new r.CodeLens(o,{title:`${s.decimalFormat.format(t.selfTime/1e3)}ms Self Time, ${s.decimalFormat.format(t.aggregateTime/1e3)}ms Total`,command:""}),new r.CodeLens(o,{title:"Clear",command:"extension.jsProfileVisualizer.table.clearCodeLenses"})]})).reduce(((e,t)=>[...e,...t]),[]))&&void 0!==o?o:[]}}t.CpuProfileAnnotations=a},450:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decimalFormat=new Intl.NumberFormat(void 0,{maximumFractionDigits:2,minimumFractionDigits:2})},410:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(496),n=o(456),i=o(618),s=o(191),a=o(948),l=o(808),c=o(116);t.CpuProfileEditorProvider=class{constructor(e,t,o={}){this.lens=e,this.bundle=t,this.extraConsts=o,this.onDidChangeCustomDocument=(new r.EventEmitter).event}async openCustomDocument(e){const t=await r.workspace.fs.readFile(e),o=JSON.parse((new TextDecoder).decode(t)),n=new s.ReadonlyCustomDocument(e,c.buildModel(o)),i=new l.CpuProfileAnnotations,a=n.userData.rootPath;for(const e of n.userData.locations)i.add(a,e);return this.lens.registerLenses(i),n}async resolveCustomEditor(e,t){t.webview.onDidReceiveMessage((t=>{var o;switch(t.type){case"openDocument":return void i.openLocation({rootPath:null===(o=e.userData)||void 0===o?void 0:o.rootPath,viewColumn:t.toSide?r.ViewColumn.Beside:r.ViewColumn.Active,callFrame:t.callFrame,location:t.location});case"reopenWith":return void a.reopenWithEditor(e.uri,t.viewType,t.requireExtension);default:console.warn(`Unknown request from webview: ${JSON.stringify(t)}`)}})),t.webview.options={enableScripts:!0},t.webview.html=await n.bundlePage(t.webview.asWebviewUri(this.bundle),{MODEL:e.userData,...this.extraConsts})}async saveCustomDocument(){}async revertCustomDocument(){}async backupCustomDocument(){return{id:"",delete:()=>{}}}saveCustomDocumentAs(e,t){return r.workspace.fs.copy(e.uri,t,{overwrite:!0})}}},116:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(748),n=o(21),i=o(480),s=(e,t)=>{const o=t[e];if(o.aggregateTime)return o.aggregateTime;let r=o.selfTime;for(const e of o.children)r+=s(e,t);return o.aggregateTime=r};t.buildModel=e=>{var t,o,a;if(!e.timeDeltas||!e.samples)return{nodes:[],locations:[],samples:e.samples||[],timeDeltas:e.timeDeltas||[],rootPath:null===(t=e.$vscode)||void 0===t?void 0:t.rootPath,duration:e.endTime-e.startTime};const{samples:l,timeDeltas:c}=e,u=(e=>{var t;if(e.$vscode)return e.$vscode.locations;let o=0;const r=new Map,n=e=>{const t=[e.functionName,e.url,e.scriptId,e.lineNumber,e.columnNumber].join(":"),n=r.get(t);if(n)return n.id;const s=o++;return r.set(t,{id:s,callFrame:e,location:{lineNumber:e.lineNumber+1,columnNumber:e.columnNumber+1,source:{name:i.maybeFileUrlToPath(e.url),path:i.maybeFileUrlToPath(e.url),sourceReference:0}}}),s};for(const o of e.nodes)o.locationId=n(o.callFrame),o.positionTicks=null===(t=o.positionTicks)||void 0===t?void 0:t.map((e=>({...e,startLocationId:n({...o.callFrame,lineNumber:e.line-1,columnNumber:0}),endLocationId:n({...o.callFrame,lineNumber:e.line,columnNumber:0})})));return[...r.values()].sort(((e,t)=>e.id-t.id)).map((e=>({locations:[e.location],callFrame:e.callFrame})))})(e),d=u.map(((t,o)=>{const i=n.getBestLocation(e,t.locations);return{id:o,selfTime:0,aggregateTime:0,ticks:0,category:r.categorize(t.callFrame,i),callFrame:t.callFrame,src:i}})),f=new Map,m=e=>{let t=f.get(e);return void 0===t&&(t=f.size,f.set(e,t)),t},h=new Array(e.nodes.length);for(let t=0;t<e.nodes.length;t++){const r=e.nodes[t],n=m(r.id);h[n]={id:n,selfTime:0,aggregateTime:0,locationId:r.locationId,children:(null===(o=r.children)||void 0===o?void 0:o.map(m))||[]};for(const e of r.positionTicks||[])e.startLocationId&&(d[e.startLocationId].ticks+=e.ticks)}for(const e of h)for(const t of e.children)h[t].parent=e.id;for(let e=1;e<c.length;e++)h[m(l[e])].selfTime+=c[e-1];for(let e=0;e<h.length;e++){const t=h[e],o=d[t.locationId];o.aggregateTime+=s(e,h),o.selfTime+=t.selfTime}return{nodes:h,locations:d,samples:l.map(m),timeDeltas:c,rootPath:null===(a=e.$vscode)||void 0===a?void 0:a.rootPath,duration:e.endTime-e.startTime}}},576:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(496),n=o(423);class i{async provideTextDocumentContent(e){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Retrieving ${e.query}...`},(async()=>{try{const t=await n.default(e.query,{}),o=await t.text();return t.ok?o:`Unexpected ${t.status} from ${e.query}: ${o}`}catch(e){return e.stack}}))}}t.DownloadFileProvider=i,i.scheme="js-viz-download"},21:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(497);t.getBestLocation=(e,t=[])=>{var o;if(!(null===(o=e.$vscode)||void 0===o?void 0:o.rootPath))return t[0];for(const o of t){const t=r.addRelativeDiskPath(e.$vscode.rootPath,o);if(t.relativePath)return t}return t[0]}},419:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decimalFormat=new Intl.NumberFormat(void 0,{maximumFractionDigits:0,minimumFractionDigits:0})},768:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(496),n=o(456),i=o(618),s=o(191),a=o(948),l=o(895),c=o(523),u=o(830);t.HeapProfileEditorProvider=class{constructor(e,t,o={}){this.lens=e,this.bundle=t,this.extraConsts=o,this.onDidChangeCustomDocument=(new r.EventEmitter).event}async openCustomDocument(e){const t=await r.workspace.fs.readFile(e),o=JSON.parse((new TextDecoder).decode(t)),n=new s.ReadonlyCustomDocument(e,c.buildModel(o)),i=u.createTree(n.userData),a=[i];let d=[i];for(;d.length;){const e=d.pop();e&&(a.push(e),d=d.concat(Object.values(e.children)))}const f=new l.HeapProfileAnnotations,m=n.userData.rootPath;for(const e of a)f.add(m,e);return this.lens.registerLenses(f),n}async resolveCustomEditor(e,t){t.webview.onDidReceiveMessage((t=>{switch(t.type){case"openDocument":return void i.openLocation({rootPath:void 0,viewColumn:t.toSide?r.ViewColumn.Beside:r.ViewColumn.Active,callFrame:t.callFrame,location:t.location});case"reopenWith":return void a.reopenWithEditor(e.uri,t.viewType,t.requireExtension);default:console.warn(`Unknown request from webview: ${JSON.stringify(t)}`)}})),t.webview.options={enableScripts:!0},t.webview.html=await n.bundlePage(t.webview.asWebviewUri(this.bundle),{MODEL:e.userData,...this.extraConsts})}async saveCustomDocument(){}async revertCustomDocument(){}async backupCustomDocument(){return{id:"",delete:()=>{}}}saveCustomDocumentAs(e,t){return r.workspace.fs.copy(e.uri,t,{overwrite:!0})}}},895:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(496),n=o(480),i=o(341),s=o(419);class a extends i.ProfileAnnotations{constructor(){super(...arguments),this.data=new Map}set(e,t,o){var i;let s=this.data.get(n.lowerCaseInsensitivePath(e));s||(s=[],this.data.set(n.lowerCaseInsensitivePath(e),s));let a=0;for(;a<s.length&&s[a].position.line<t.line;)a++;if((null===(i=s[a])||void 0===i?void 0:i.position.line)===t.line){const e=s[a];t.character<e.position.character&&(e.position=new r.Position(t.line,t.character)),e.data.totalSize+=o.totalSize,e.data.selfSize+=o.selfSize}else s.splice(a,0,{position:new r.Position(t.line,t.character),data:{totalSize:o.totalSize,selfSize:o.selfSize}})}getLensesForFile(e){var t,o;return this.expandForFile(e),null!==(o=null===(t=this.data.get(n.lowerCaseInsensitivePath(e)))||void 0===t?void 0:t.map((({position:e,data:t})=>{if(0===t.totalSize&&0===t.selfSize)return[];const o=new r.Range(e,e);return[new r.CodeLens(o,{title:`${s.decimalFormat.format(t.selfSize/1e3)}kB Self Size, ${s.decimalFormat.format(t.totalSize/1e3)}kB Total Size`,command:""}),new r.CodeLens(o,{title:"Clear",command:"extension.jsProfileVisualizer.table.clearCodeLenses"})]})).reduce(((e,t)=>[...e,...t]),[]))&&void 0!==o?o:[]}}t.HeapProfileAnnotations=a},523:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(21),n=o(480);t.buildModel=e=>{var t;let o=[e.head];const i=(e=>{if(e.$vscode)return e.$vscode.locations;let t=0;const o=new Map,r=e=>{const r=[e.functionName,e.url,e.scriptId,e.lineNumber,e.columnNumber].join(":"),i=o.get(r);if(i)return i.id;const s=t++;return o.set(r,{id:s,callFrame:e,location:{lineNumber:e.lineNumber+1,columnNumber:e.columnNumber+1,source:{name:n.maybeFileUrlToPath(e.url),path:n.maybeFileUrlToPath(e.url),sourceReference:0}}}),s};let i=[e.head];for(;i.length;){const e=i.pop();if(e){const{callFrame:t}=e;e.locationId=r(t),i=i.concat(e.children)}}return[...o.values()].sort(((e,t)=>e.id-t.id)).map((e=>({locations:[e.location],callFrame:e.callFrame})))})(e);for(;o.length;){const t=o.pop();t&&(t.locationId&&(t.src=r.getBestLocation(e,i[t.locationId].locations)),o=o.concat(t.children))}return{head:e.head,samples:e.samples,rootPath:null===(t=e.$vscode)||void 0===t?void 0:t.rootPath}}},830:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(748);class n{constructor(e,t){this.node=e,this.parent=t,this.children={},this.totalSize=0,this.selfSize=0,this.childrenSize=0,this.category=r.categorize(e.callFrame,void 0)}static root(){return new n({id:-1,selfSize:0,children:[],callFrame:{functionName:"(root)",lineNumber:-1,columnNumber:-1,scriptId:"0",url:""}})}get id(){return this.node.id}get callFrame(){return this.node.callFrame}get src(){return this.node.src}toJSON(){return{category:this.category,children:this.children,childrenSize:this.childrenSize,selfSize:this.selfSize,totalSize:this.totalSize,id:this.id,callFrame:this.callFrame,src:this.src}}}t.TreeNode=n;const i=(e,t)=>{const o=new n(e,t);e.children.forEach((e=>{const t=i(e,o);o.children[t.id]=t,o.childrenSize++})),o.selfSize=e.selfSize,o.totalSize=e.selfSize;for(const e in o.children)o.totalSize+=o.children[e].totalSize;return o};t.createTree=e=>{const t=n.root();for(const o of e.head.children){const e=i(o,t);t.children[e.id]=e,t.childrenSize++}for(const e in t.children)t.totalSize+=t.children[e].totalSize;return t}},497:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(480);t.addRelativeDiskPath=(e,t)=>t.source.path&&0===t.source.sourceReference?{...t,relativePath:r.properRelative(e,t.source.path)}:t},385:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.makeNonce=function(e=32){let t="";for(let r=0;r<e;r++)t+=o[Math.floor(Math.random()*o.length)];return t},t.nonceHeader=e=>`<meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline'; script-src 'nonce-${e}';">`},618:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(496),n=o(480),i=o(17),s=o(37),a=o(576);t.openLocation=async({rootPath:e,location:t,viewColumn:o,callFrame:n})=>{t&&await c(e,t,o)||n&&await u(n,o)||r.window.showErrorMessage("Could not find the file in your workspace")};const l=async(e,t,o,n)=>{const i=new r.Position(Math.max(0,t-1),Math.max(0,o-1));await r.window.showTextDocument(e,{viewColumn:n,selection:new r.Range(i,i)})},c=async(e,o,i)=>{const s=t.getCandidateDiskPaths(e,o.source),a=(await Promise.all(s.map(n.exists))).findIndex((e=>e));if(-1===a)return!1;const c=await r.workspace.openTextDocument(r.Uri.file(s[a]));return await l(c,o.lineNumber,o.columnNumber,i),!0},u=async({url:e,lineNumber:t,columnNumber:o},n)=>{var c,u;let d;try{d=new URL(e)}catch{return!1}if("http:"!==d.protocol&&"https:"!==d.protocol)return!1;const f=i.resolve(null!==(u=null===(c=r.workspace.workspaceFolders)||void 0===c?void 0:c[0].uri.fsPath)&&void 0!==u?u:s.tmpdir(),d.pathname.slice(1)||"index.js"),m=await r.workspace.openTextDocument(r.Uri.file(f).with({scheme:a.DownloadFileProvider.scheme,query:e}));return await l(m,t+1,o+1,n),!0};t.getCandidateDiskPaths=(e,t)=>{var o;if(!t.path)return[];const s=[t.path];if(!e)return s;for(const a of null!==(o=r.workspace.workspaceFolders)&&void 0!==o?o:[])s.push(i.resolve(a.uri.fsPath,n.properRelative(e,t.path)));return s}},480:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(17),n=o(496);t.exists=async e=>{try{return await n.workspace.fs.stat(n.Uri.file(e)),!0}catch{return!1}},t.properRelative=function(e,t){var o,n;return(null===(o=r.posix)||void 0===o?void 0:o.isAbsolute(e))?r.posix.relative(e,t):(null===(n=r.win32)||void 0===n?void 0:n.isAbsolute(e))?r.win32.relative(e,t):r.relative(e,t)};let i="win32"!==process.platform;t.resetCaseSensitivePaths=function(){i="win32"!==process.platform},t.setCaseSensitivePaths=function(e){i=e},t.getCaseSensitivePaths=function(){return i},t.lowerCaseInsensitivePath=function(e){return i?e:e.toLowerCase()},t.maybeFileUrlToPath=function(e){return e.startsWith("file:///")?(e=e.replace("file:///",""),"/"===(e=decodeURIComponent(e))[0]||e.match(/^[A-Za-z]:/)||(e="/"+e),t.isWindowsPath(e)&&(e=e[0].toLowerCase()+e.substr(1)),e):e},t.isWindowsPath=e=>/^[A-Za-z]:/.test(e)},341:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(496),n=o(553),i=o(618),s=/[^/\\]+$/;t.getBasename=e=>{var t,o;return null!==(o=null===(t=s.exec(e))||void 0===t?void 0:t[0])&&void 0!==o?o:e},t.ProfileAnnotations=class{constructor(){this.basenamesToExpand=new Map}add(e,o){var s;const a=n.once((()=>{this.set(o.callFrame.url,new r.Position(Math.max(0,o.callFrame.lineNumber),Math.max(0,o.callFrame.columnNumber)),o);const t=o.src;if(t&&0===t.source.sourceReference&&t.source.path&&t.source.path!==o.callFrame.url)for(const n of i.getCandidateDiskPaths(e,t.source))this.set(n,new r.Position(Math.max(0,t.lineNumber-1),Math.max(0,t.columnNumber-1)),o)}));this.addExpansionFn(t.getBasename(o.callFrame.url),a),(null===(s=o.src)||void 0===s?void 0:s.source.path)&&this.addExpansionFn(t.getBasename(o.src.source.path),a)}addExpansionFn(e,t){let o=this.basenamesToExpand.get(e);o||(o=[],this.basenamesToExpand.set(e,o)),o.push(t)}expandForFile(e){const o=t.getBasename(e),r=this.basenamesToExpand.get(o);if(r){for(const e of r)e();this.basenamesToExpand.delete(o)}}}},144:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(496),n=o(576),i=o(480);t.ProfileCodeLensProvider=class{constructor(){this.changeEmitter=new r.EventEmitter,this.onDidChangeCodeLenses=this.changeEmitter.event}registerLenses(e){return r.commands.executeCommand("setContext","jsProfileVisualizer.hasCodeLenses",!0),this.lenses=e,{dispose:()=>{this.lenses===e&&this.clear()}}}clear(){this.lenses&&(this.lenses=void 0,r.commands.executeCommand("setContext","jsProfileVisualizer.hasCodeLenses",!1),this.changeEmitter.fire())}provideCodeLenses(e){var t,o;const r=null===(t=this.lenses)||void 0===t?void 0:t.getLensesForFile(i.lowerCaseInsensitivePath(e.uri.fsPath));if(r)return r;return(e.uri.scheme===n.DownloadFileProvider.scheme?null===(o=this.lenses)||void 0===o?void 0:o.getLensesForFile(e.uri.query):void 0)||[]}}},191:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReadonlyCustomDocument=class{constructor(e,t){this.uri=e,this.userData=t}dispose(){}}},948:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=o(496);t.reopenWithEditor=function(e,t,o){o&&!r.extensions.all.some((e=>e.id===o))?r.commands.executeCommand("workbench.extensions.action.showExtensionsWithIds",[o]):r.commands.executeCommand("vscode.openWith",e,t,r.ViewColumn.Active)}},496:e=>{e.exports=require("vscode")},37:e=>{e.exports=require("os")},17:e=>{e.exports=require("path")},423:(e,t,o)=>{o.r(t),o.d(t,{FetchError:()=>f,Headers:()=>F,Request:()=>q,Response:()=>M,default:()=>G});const r=require("stream"),n=require("http"),i=require("url"),s=require("https"),a=require("zlib"),l=r.Readable,c=Symbol("buffer"),u=Symbol("type");class d{constructor(){this[u]="";const e=arguments[0],t=arguments[1],o=[];let r=0;if(e){const t=e,n=Number(t.length);for(let e=0;e<n;e++){const n=t[e];let i;i=n instanceof Buffer?n:ArrayBuffer.isView(n)?Buffer.from(n.buffer,n.byteOffset,n.byteLength):n instanceof ArrayBuffer?Buffer.from(n):n instanceof d?n[c]:Buffer.from("string"==typeof n?n:String(n)),r+=i.length,o.push(i)}}this[c]=Buffer.concat(o);let n=t&&void 0!==t.type&&String(t.type).toLowerCase();n&&!/[^\u0020-\u007E]/.test(n)&&(this[u]=n)}get size(){return this[c].length}get type(){return this[u]}text(){return Promise.resolve(this[c].toString())}arrayBuffer(){const e=this[c],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){const e=new l;return e._read=function(){},e.push(this[c]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,t=arguments[0],o=arguments[1];let r,n;r=void 0===t?0:t<0?Math.max(e+t,0):Math.min(t,e),n=void 0===o?e:o<0?Math.max(e+o,0):Math.min(o,e);const i=Math.max(n-r,0),s=this[c].slice(r,r+i),a=new d([],{type:arguments[2]});return a[c]=s,a}}function f(e,t,o){Error.call(this,e),this.message=e,this.type=t,o&&(this.code=this.errno=o.code),Error.captureStackTrace(this,this.constructor)}let m;Object.defineProperties(d.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(d.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.name="FetchError";try{m=require("encoding").convert}catch(e){}const h=Symbol("Body internals"),p=r.PassThrough;function b(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.size;let i=void 0===n?0:n;var s=o.timeout;let a=void 0===s?0:s;null==e?e=null:v(e)?e=Buffer.from(e.toString()):g(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof r||(e=Buffer.from(String(e)))),this[h]={body:e,disturbed:!1,error:null},this.size=i,this.timeout=a,e instanceof r&&e.on("error",(function(e){const o="AbortError"===e.name?e:new f(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[h].error=o}))}function y(){var e=this;if(this[h].disturbed)return b.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[h].disturbed=!0,this[h].error)return b.Promise.reject(this[h].error);let t=this.body;if(null===t)return b.Promise.resolve(Buffer.alloc(0));if(g(t)&&(t=t.stream()),Buffer.isBuffer(t))return b.Promise.resolve(t);if(!(t instanceof r))return b.Promise.resolve(Buffer.alloc(0));let o=[],n=0,i=!1;return new b.Promise((function(r,s){let a;e.timeout&&(a=setTimeout((function(){i=!0,s(new f(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))}),e.timeout)),t.on("error",(function(t){"AbortError"===t.name?(i=!0,s(t)):s(new f(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))})),t.on("data",(function(t){if(!i&&null!==t){if(e.size&&n+t.length>e.size)return i=!0,void s(new f(`content size at ${e.url} over limit: ${e.size}`,"max-size"));n+=t.length,o.push(t)}})),t.on("end",(function(){if(!i){clearTimeout(a);try{r(Buffer.concat(o,n))}catch(t){s(new f(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}}))}))}function v(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function g(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function w(e){let t,o,n=e.body;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof r&&"function"!=typeof n.getBoundary&&(t=new p,o=new p,n.pipe(t),n.pipe(o),e[h].body=t,n=o),n}function P(e){return null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":v(e)?"application/x-www-form-urlencoded;charset=UTF-8":g(e)?e.type||null:Buffer.isBuffer(e)||"[object ArrayBuffer]"===Object.prototype.toString.call(e)||ArrayBuffer.isView(e)?null:"function"==typeof e.getBoundary?`multipart/form-data;boundary=${e.getBoundary()}`:e instanceof r?null:"text/plain;charset=UTF-8"}function T(e){const t=e.body;return null===t?0:g(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}b.prototype={get body(){return this[h].body},get bodyUsed(){return this[h].disturbed},arrayBuffer(){return y.call(this).then((function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}))},blob(){let e=this.headers&&this.headers.get("content-type")||"";return y.call(this).then((function(t){return Object.assign(new d([],{type:e.toLowerCase()}),{[c]:t})}))},json(){var e=this;return y.call(this).then((function(t){try{return JSON.parse(t.toString())}catch(t){return b.Promise.reject(new f(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}}))},text(){return y.call(this).then((function(e){return e.toString()}))},buffer(){return y.call(this)},textConverted(){var e=this;return y.call(this).then((function(t){return function(e,t){if("function"!=typeof m)throw new Error("The package `encoding` must be installed to use the textConverted() function");const o=t.get("content-type");let r,n,i="utf-8";return o&&(r=/charset=([^;]*)/i.exec(o)),n=e.slice(0,1024).toString(),!r&&n&&(r=/<meta.+?charset=(['"])(.+?)\1/i.exec(n)),!r&&n&&(r=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(n),r||(r=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(n),r&&r.pop()),r&&(r=/charset=(.*)/i.exec(r.pop()))),!r&&n&&(r=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(n)),r&&(i=r.pop(),"gb2312"!==i&&"gbk"!==i||(i="gb18030")),m(e,"UTF-8",i).toString()}(t,e.headers)}))}},Object.defineProperties(b.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),b.mixIn=function(e){for(const t of Object.getOwnPropertyNames(b.prototype))if(!(t in e)){const o=Object.getOwnPropertyDescriptor(b.prototype,t);Object.defineProperty(e,t,o)}},b.Promise=global.Promise;const S=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,C=/[^\t\x20-\x7e\x80-\xff]/;function x(e){if(e=`${e}`,S.test(e)||""===e)throw new TypeError(`${e} is not a legal HTTP header name`)}function j(e){if(e=`${e}`,C.test(e))throw new TypeError(`${e} is not a legal HTTP header value`)}function O(e,t){t=t.toLowerCase();for(const o in e)if(o.toLowerCase()===t)return o}const E=Symbol("map");class F{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[E]=Object.create(null),e instanceof F){const t=e.raw(),o=Object.keys(t);for(const e of o)for(const o of t[e])this.append(e,o)}else if(null==e);else{if("object"!=typeof e)throw new TypeError("Provided initializer must be an object");{const t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw new TypeError("Header pairs must be iterable");const o=[];for(const t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw new TypeError("Each header pair must be iterable");o.push(Array.from(t))}for(const e of o){if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(const t of Object.keys(e)){const o=e[t];this.append(t,o)}}}}get(e){x(e=`${e}`);const t=O(this[E],e);return void 0===t?null:this[E][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=z(this),r=0;for(;r<o.length;){var n=o[r];const i=n[0],s=n[1];e.call(t,s,i,this),o=z(this),r++}}set(e,t){t=`${t}`,x(e=`${e}`),j(t);const o=O(this[E],e);this[E][void 0!==o?o:e]=[t]}append(e,t){t=`${t}`,x(e=`${e}`),j(t);const o=O(this[E],e);void 0!==o?this[E][o].push(t):this[E][e]=[t]}has(e){return x(e=`${e}`),void 0!==O(this[E],e)}delete(e){x(e=`${e}`);const t=O(this[E],e);void 0!==t&&delete this[E][t]}raw(){return this[E]}keys(){return L(this,"key")}values(){return L(this,"value")}[Symbol.iterator](){return L(this,"key+value")}}function z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";const o=Object.keys(e[E]).sort();return o.map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[E][t].join(", ")}:function(t){return[t.toLowerCase(),e[E][t].join(", ")]})}F.prototype.entries=F.prototype[Symbol.iterator],Object.defineProperty(F.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(F.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const D=Symbol("internal");function L(e,t){const o=Object.create(k);return o[D]={target:e,kind:t,index:0},o}const k=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==k)throw new TypeError("Value of `this` is not a HeadersIterator");var e=this[D];const t=e.target,o=e.kind,r=e.index,n=z(t,o);return r>=n.length?{value:void 0,done:!0}:(this[D].index=r+1,{value:n[r],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function $(e){const t=Object.assign({__proto__:null},e[E]),o=O(e[E],"Host");return void 0!==o&&(t[o]=t[o][0]),t}Object.defineProperty(k,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});const _=Symbol("Response internals"),B=n.STATUS_CODES;class M{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b.call(this,e,t);const o=t.status||200,r=new F(t.headers);if(null!=e&&!r.has("Content-Type")){const t=P(e);t&&r.append("Content-Type",t)}this[_]={url:t.url,status:o,statusText:t.statusText||B[o],headers:r,counter:t.counter}}get url(){return this[_].url||""}get status(){return this[_].status}get ok(){return this[_].status>=200&&this[_].status<300}get redirected(){return this[_].counter>0}get statusText(){return this[_].statusText}get headers(){return this[_].headers}clone(){return new M(w(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}b.mixIn(M.prototype),Object.defineProperties(M.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(M.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const N=Symbol("Request internals"),A=i.parse,R=i.format,U="destroy"in r.Readable.prototype;function I(e){return"object"==typeof e&&"object"==typeof e[N]}class q{constructor(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};I(e)?t=A(e.url):(t=e&&e.href?A(e.href):A(`${e}`),e={});let r=o.method||e.method||"GET";if(r=r.toUpperCase(),(null!=o.body||I(e)&&null!==e.body)&&("GET"===r||"HEAD"===r))throw new TypeError("Request with GET/HEAD method cannot have body");let n=null!=o.body?o.body:I(e)&&null!==e.body?w(e):null;b.call(this,n,{timeout:o.timeout||e.timeout||0,size:o.size||e.size||0});const i=new F(o.headers||e.headers||{});if(null!=n&&!i.has("Content-Type")){const e=P(n);e&&i.append("Content-Type",e)}let s=I(e)?e.signal:null;if("signal"in o&&(s=o.signal),null!=s&&!function(e){const t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!(!t||"AbortSignal"!==t.constructor.name)}(s))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[N]={method:r,redirect:o.redirect||e.redirect||"follow",headers:i,parsedURL:t,signal:s},this.follow=void 0!==o.follow?o.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==o.compress?o.compress:void 0===e.compress||e.compress,this.counter=o.counter||e.counter||0,this.agent=o.agent||e.agent}get method(){return this[N].method}get url(){return R(this[N].parsedURL)}get headers(){return this[N].headers}get redirect(){return this[N].redirect}get signal(){return this[N].signal}clone(){return new q(this)}}function H(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}b.mixIn(q.prototype),Object.defineProperty(q.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(q.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),H.prototype=Object.create(Error.prototype),H.prototype.constructor=H,H.prototype.name="AbortError";const V=r.PassThrough,W=i.resolve;function J(e,t){if(!J.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return b.Promise=J.Promise,new J.Promise((function(o,i){const l=new q(e,t),c=function(e){const t=e[N].parsedURL,o=new F(e[N].headers);if(o.has("Accept")||o.set("Accept","*/*"),!t.protocol||!t.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof r.Readable&&!U)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(n="0"),null!=e.body){const t=T(e);"number"==typeof t&&(n=String(t))}n&&o.set("Content-Length",n),o.has("User-Agent")||o.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!o.has("Accept-Encoding")&&o.set("Accept-Encoding","gzip,deflate");let i=e.agent;return"function"==typeof i&&(i=i(t)),o.has("Connection")||i||o.set("Connection","close"),Object.assign({},t,{method:e.method,headers:$(o),agent:i})}(l),u=("https:"===c.protocol?s:n).request,d=l.signal;let m=null;const h=function(){let e=new H("The user aborted a request.");i(e),l.body&&l.body instanceof r.Readable&&l.body.destroy(e),m&&m.body&&m.body.emit("error",e)};if(d&&d.aborted)return void h();const p=function(){h(),v()},b=u(c);let y;function v(){b.abort(),d&&d.removeEventListener("abort",p),clearTimeout(y)}d&&d.addEventListener("abort",p),l.timeout&&b.once("socket",(function(e){y=setTimeout((function(){i(new f(`network timeout at: ${l.url}`,"request-timeout")),v()}),l.timeout)})),b.on("error",(function(e){i(new f(`request to ${l.url} failed, reason: ${e.message}`,"system",e)),v()})),b.on("response",(function(e){clearTimeout(y);const t=function(e){const t=new F;for(const o of Object.keys(e))if(!S.test(o))if(Array.isArray(e[o]))for(const r of e[o])C.test(r)||(void 0===t[E][o]?t[E][o]=[r]:t[E][o].push(r));else C.test(e[o])||(t[E][o]=[e[o]]);return t}(e.headers);if(J.isRedirect(e.statusCode)){const r=t.get("Location"),n=null===r?null:W(l.url,r);switch(l.redirect){case"error":return i(new f(`uri requested responds with a redirect, redirect mode is set to error: ${l.url}`,"no-redirect")),void v();case"manual":if(null!==n)try{t.set("Location",n)}catch(e){i(e)}break;case"follow":if(null===n)break;if(l.counter>=l.follow)return i(new f(`maximum redirect reached at: ${l.url}`,"max-redirect")),void v();const r={headers:new F(l.headers),follow:l.follow,counter:l.counter+1,agent:l.agent,compress:l.compress,method:l.method,body:l.body,signal:l.signal,timeout:l.timeout,size:l.size};return 303!==e.statusCode&&l.body&&null===T(l)?(i(new f("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void v()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==l.method)||(r.method="GET",r.body=void 0,r.headers.delete("content-length")),o(J(new q(n,r))),void v())}}e.once("end",(function(){d&&d.removeEventListener("abort",p)}));let r=e.pipe(new V);const n={url:l.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:l.size,timeout:l.timeout,counter:l.counter},s=t.get("Content-Encoding");if(!l.compress||"HEAD"===l.method||null===s||204===e.statusCode||304===e.statusCode)return m=new M(r,n),void o(m);const c={flush:a.Z_SYNC_FLUSH,finishFlush:a.Z_SYNC_FLUSH};if("gzip"==s||"x-gzip"==s)return r=r.pipe(a.createGunzip(c)),m=new M(r,n),void o(m);if("deflate"!=s&&"x-deflate"!=s){if("br"==s&&"function"==typeof a.createBrotliDecompress)return r=r.pipe(a.createBrotliDecompress()),m=new M(r,n),void o(m);m=new M(r,n),o(m)}else e.pipe(new V).once("data",(function(e){r=8==(15&e[0])?r.pipe(a.createInflate()):r.pipe(a.createInflateRaw()),m=new M(r,n),o(m)}))})),function(e,t){const o=t.body;null===o?e.end():g(o)?o.stream().pipe(e):Buffer.isBuffer(o)?(e.write(o),e.end()):o.pipe(e)}(b,l)}))}J.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},J.Promise=global.Promise;const G=J}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0});const t=o(496),n=o(410),i=o(576),s=o(768),a=o(144);e.activate=function(e){const o=new a.ProfileCodeLensProvider;e.subscriptions.push(t.window.registerCustomEditorProvider("jsProfileVisualizer.cpuprofile.table",new n.CpuProfileEditorProvider(o,t.Uri.joinPath(e.extensionUri,"out","cpu-client.bundle.js"))),t.window.registerCustomEditorProvider("jsProfileVisualizer.heapprofile.table",new s.HeapProfileEditorProvider(o,t.Uri.joinPath(e.extensionUri,"out","heap-client.bundle.js"))),t.workspace.registerTextDocumentContentProvider("js-viz-download",new i.DownloadFileProvider),t.languages.registerCodeLensProvider("*",o),t.commands.registerCommand("extension.jsProfileVisualizer.table.clearCodeLenses",(()=>o.clear())))},e.deactivate=function(){}})(),module.exports=r})();